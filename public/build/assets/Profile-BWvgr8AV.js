import{g as q,p as Z,k as W,aE as X,Q as aa,a as ea,aF as ta,O as la,r as m,s as _,aG as oa,l as sa,w as M,i as J,aH as na,f as ra,b as ua,aI as A,v as t,x as B,aJ as ia,o as ca,m as da,aK as ma,Z as va,aL as fa,aM as pa,aN as ba,J as Va,a3 as wa,z as ya,aO as ka,d as P,aP as ga,a5 as Ca,a7 as Pa,a8 as o,ax as Sa,ab as Ta,ay as F,az as T,an as R,aC as E,ag as w,ao as O,aQ as U,aj as z,aR as g,A as x,al as xa,aq as D}from"./app-Ci9VaRBz.js";import{V as _a,b as Na}from"./layout-DYTwUSDa.js";function Ia(e){const c=_(e());let r=-1;function l(){clearInterval(r)}function d(){l(),wa(()=>c.value=e())}function i(v){const b=v?getComputedStyle(v):{transitionDuration:.2},p=parseFloat(b.transitionDuration)*1e3||200;if(l(),c.value<=0)return;const f=performance.now();r=window.setInterval(()=>{const y=performance.now()-f+p;c.value=Math.max(e()-y,0),c.value<=0&&l()},p)}return Va(l),{clear:l,time:c,start:i,reset:d}}const La=Z({multiLine:Boolean,text:String,timer:[Boolean,String],timeout:{type:[Number,String],default:5e3},vertical:Boolean,...pa({location:"bottom"}),...fa(),...va(),...ma(),...da(),...ca(ba({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","retainFocus","captureFocus","disableInitialFocus","scrim","scrollStrategy","stickToTarget","viewportMargin"])},"VSnackbar"),Ma=q()({name:"VSnackbar",props:La(),emits:{"update:modelValue":e=>!0},setup(e,c){let{slots:r}=c;const l=W(e,"modelValue"),{positionClasses:d}=X(e),{scopeId:i}=aa(),{themeClasses:v}=ea(e),{colorClasses:b,colorStyles:p,variantClasses:f}=ta(e),{roundedClasses:y}=la(e),V=Ia(()=>Number(e.timeout)),n=m(),a=m(),s=_(!1),N=_(0),I=m(),G=oa(_a,void 0);sa(()=>!!G,()=>{const u=Na();ya(()=>{I.value=u.mainStyles.value})}),M(l,C),M(()=>e.timeout,C),J(()=>{l.value&&C()});let S=-1;function C(){V.reset(),window.clearTimeout(S);const u=Number(e.timeout);if(!l.value||u===-1)return;const k=na(a.value);V.start(k),S=window.setTimeout(()=>{l.value=!1},u)}function Y(){V.reset(),window.clearTimeout(S)}function h(){s.value=!0,Y()}function L(){s.value=!1,C()}function j(u){N.value=u.touches[0].clientY}function H(u){Math.abs(N.value-u.changedTouches[0].clientY)>50&&(l.value=!1)}function K(){s.value&&L()}const Q=ra(()=>e.location.split(" ").reduce((u,k)=>(u[`v-snackbar--${k}`]=!0,u),{}));return ua(()=>{const u=A.filterProps(e),k=!!(r.default||r.text||e.text);return t(A,B({ref:n,class:["v-snackbar",{"v-snackbar--active":l.value,"v-snackbar--multi-line":e.multiLine&&!e.vertical,"v-snackbar--timer":!!e.timer,"v-snackbar--vertical":e.vertical},Q.value,d.value,e.class],style:[I.value,e.style]},u,{modelValue:l.value,"onUpdate:modelValue":$=>l.value=$,contentProps:B({class:["v-snackbar__wrapper",v.value,b.value,y.value,f.value],style:[p.value],onPointerenter:h,onPointerleave:L},u.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none",_disableGlobalStack:!0,onTouchstartPassive:j,onTouchend:H,onAfterLeave:K},i),{default:()=>[ka(!1,"v-snackbar"),e.timer&&!s.value&&P("div",{key:"timer",class:"v-snackbar__timer"},[t(ga,{ref:a,color:typeof e.timer=="string"?e.timer:"info",max:e.timeout,modelValue:V.time.value},null)]),k&&P("div",{key:"content",class:"v-snackbar__content",role:"status","aria-live":"polite"},[r.text?.()??e.text,r.default?.()]),r.actions&&t(Ca,{defaults:{VBtn:{variant:"text",ripple:!1,slim:!0}}},{default:()=>[P("div",{class:"v-snackbar__actions"},[r.actions({isActive:l})])]})],activator:r.activator})}),ia({},n)}}),Fa={__name:"Profile",setup(e){const c=m(null),r=m(!1),l=m(!1),d=m({name:"",email:""}),i=m({current_password:"",password:"",password_confirmation:""}),v=m(!1),b=m(""),p=m("success"),f=(n,a="success")=>{b.value=n,p.value=a,v.value=!0};J(()=>{const n=localStorage.getItem("user");n&&(c.value=JSON.parse(n),d.value.name=c.value.name,d.value.email=c.value.email)});const y=async()=>{r.value=!0;try{const n=await D.put("/api/profile",{name:d.value.name});localStorage.setItem("user",JSON.stringify(n.data.user)),f("Perfil actualizado correctamente"),setTimeout(()=>location.reload(),1e3)}catch(n){console.error(n),f("Error al actualizar perfil","error")}finally{r.value=!1}},V=async()=>{l.value=!0;try{await D.put("/api/password",i.value),f("Contraseña actualizada. Inicia sesión de nuevo."),i.value={current_password:"",password:"",password_confirmation:""}}catch(n){console.error(n);const a=n.response?.data?.message||"Error al cambiar contraseña";f(a,"error")}finally{l.value=!1}};return(n,a)=>(Ta(),Pa(Sa,null,{default:o(()=>[t(F,null,{default:o(()=>[t(T,{cols:"12"},{default:o(()=>[...a[7]||(a[7]=[P("h2",{class:"text-h5 mb-4"},"Mi Perfil",-1)])]),_:1})]),_:1}),t(F,null,{default:o(()=>[t(T,{cols:"12",md:"6"},{default:o(()=>[t(R,{class:"mb-4"},{default:o(()=>[t(E,null,{default:o(()=>[...a[8]||(a[8]=[w("Información Personal",-1)])]),_:1}),t(O,null,{default:o(()=>[t(U,{onSubmit:z(y,["prevent"])},{default:o(()=>[t(g,{modelValue:d.value.name,"onUpdate:modelValue":a[0]||(a[0]=s=>d.value.name=s),label:"Nombre Completo",variant:"outlined",class:"mb-2"},null,8,["modelValue"]),t(g,{modelValue:d.value.email,"onUpdate:modelValue":a[1]||(a[1]=s=>d.value.email=s),label:"Correo Electrónico",variant:"outlined",disabled:"",hint:"El correo no se puede cambiar","persistent-hint":""},null,8,["modelValue"]),t(x,{color:"primary",type:"submit",loading:r.value,class:"mt-4"},{default:o(()=>[...a[9]||(a[9]=[w(" Guardar Cambios ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1}),t(T,{cols:"12",md:"6"},{default:o(()=>[t(R,null,{default:o(()=>[t(E,null,{default:o(()=>[...a[10]||(a[10]=[w("Cambiar Contraseña",-1)])]),_:1}),t(O,null,{default:o(()=>[t(U,{onSubmit:z(V,["prevent"])},{default:o(()=>[t(g,{modelValue:i.value.current_password,"onUpdate:modelValue":a[2]||(a[2]=s=>i.value.current_password=s),label:"Contraseña Actual",type:"password",variant:"outlined",class:"mb-2"},null,8,["modelValue"]),t(g,{modelValue:i.value.password,"onUpdate:modelValue":a[3]||(a[3]=s=>i.value.password=s),label:"Nueva Contraseña",type:"password",variant:"outlined",class:"mb-2"},null,8,["modelValue"]),t(g,{modelValue:i.value.password_confirmation,"onUpdate:modelValue":a[4]||(a[4]=s=>i.value.password_confirmation=s),label:"Confirmar Nueva Contraseña",type:"password",variant:"outlined"},null,8,["modelValue"]),t(x,{color:"warning",type:"submit",loading:l.value,class:"mt-4"},{default:o(()=>[...a[11]||(a[11]=[w(" Actualizar Contraseña ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(Ma,{modelValue:v.value,"onUpdate:modelValue":a[6]||(a[6]=s=>v.value=s),color:p.value},{actions:o(()=>[t(x,{variant:"text",onClick:a[5]||(a[5]=s=>v.value=!1)},{default:o(()=>[...a[12]||(a[12]=[w("Cerrar",-1)])]),_:1})]),default:o(()=>[w(xa(b.value)+" ",1)]),_:1},8,["modelValue","color"])]),_:1}))}};export{Fa as default};
